---
name: start-work
description: Start work on a Feature/Bug/Chore issue by creating a git worktree. Use when user wants to work on something, implement a feature, start development, or confirms work on a Linear issue. Uses Linear's auto-generated branch name and gwq for worktree creation. Do NOT load for: Thinking issues, code review, deployment.
allowed-tools: ["Bash", "Read", "Write", "mcp__plugin_linear_linear__*", "AskUserQuestion", "Skill"]
user-invocable: true
---

# Start Work Skill

Create a git worktree for isolated development and switch to it.

## Type Label Check (CRITICAL)

**This skill is ONLY for issues with these Type Labels:**

| Type Label | Worktree | This Skill |
|------------|----------|------------|
| **Feature** | Required | ✓ Use |
| **Bug** | Required | ✓ Use |
| **Chore** | Required | ✓ Use |
| **Thinking** | Not needed | ✗ Skip |

**Check Type Label FIRST before proceeding.**

If the issue is labeled "Thinking" → Inform user: no worktree needed for thinking/design work.

## Configuration

**Team Selection:** Query available teams dynamically using `mcp__plugin_linear_linear__list_teams`. If only one team exists, use it automatically.

## Prerequisites

- Current directory is a git repository
- gwq command is available
- Linear MCP tools are available

## Critical Rules

1. **NEVER create branch names locally** - always use Linear's auto-generated name
2. **NEVER work on main branch** - always create a worktree first
3. **Check Type Label** - Only Feature/Bug/Chore need worktrees
4. Branch name format: `{type}/dev-{issue-number}-<title-slug>`

## Workflow

### Step 1: Pre-check Branch

Check current branch:
```bash
git branch --show-current
```

If on main/master: proceed to Step 2
If on feature branch: ask user intent using AskUserQuestion:
- Continue in current worktree?
- Create a new worktree for a different issue?

### Step 2: Issue Resolution

First, determine team: `mcp__plugin_linear_linear__list_teams`

**Option A: Search existing issues**

Use `mcp__plugin_linear_linear__list_issues`:
```json
{
  "team": "<selected-team>",
  "assignee": "me"
}
```

Or search by query:
```json
{
  "team": "<selected-team>",
  "query": "<user's task description>"
}
```

Note: No state filter - search across all states (Todo, In Progress, etc.)

**Option B: Multiple matches**

Present candidates to user with AskUserQuestion.
Show issue title and Type Label to help selection.

**Option C: No matching issue found**

Invoke the `linear-issue` skill:
```
Use Skill tool with skill: "linear-issue"
```

### Step 3: Validate Type Label

Check the issue's Type Label:

- **Feature / Bug / Chore** → Proceed to Step 4
- **Thinking** → Stop. Inform user: "This is a Thinking issue. No worktree needed for design/research work."

### Step 4: Get Branch Name

Use `mcp__plugin_linear_linear__get_issue` with the selected issue ID.
Extract the `branchName` field (auto-generated by Linear).

### Step 5: Get Repository URL

```bash
git remote get-url origin
```

Parse URL to: `github.com/owner/repo` format

### Step 6: Create Worktree

```bash
gwq add -b <branch-name>
```

Creates worktree at: `~/repos/github.com/<owner>/<repo>=<branch-name-sanitized>`

### Step 7: Copy Settings

```bash
mkdir -p <new-worktree>/.claude
cp <original-repo>/.claude/settings.local.json <new-worktree>/.claude/
```

Only copy if source file exists.

### Step 8: Report New Worktree

Provide to user:
1. Worktree path created
2. Linear issue link
3. Branch name being used
4. Instruction:
   ```
   cd ~/repos/github.com/<owner>/<repo>=<branch-name>
   ```

## Error Handling

| Scenario | Action |
|----------|--------|
| Type is Thinking | Inform: no worktree needed |
| Worktree exists | Ask: switch or recreate? |
| No issue found | Create via `linear-issue` skill |
| gwq fails | Check: `which gwq` |
| Not in git repo | Fail with clear message |

## gwq Command Reference

```bash
gwq add -b <branch-name>   # Create worktree for new branch
gwq add <branch-name>      # Create for existing branch
gwq list -g                # List all worktrees
gwq remove <path>          # Remove worktree
```

## Daily Flow

1. Notice task → Create Linear Issue (`linear-issue` skill)
2. Set Type Label (Feature/Bug/Chore) + Repository Label
3. Start work → This skill creates worktree
4. Implement → PR
5. Merge
6. Linear auto-updates to Done
